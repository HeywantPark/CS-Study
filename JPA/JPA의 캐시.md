JPA의 캐시
============

## JPA 캐시
> JPA에서 캐시 처리가 가능한 이유?
  - 데이터베이스 4가지 속성중 하나인 영속성으로 인해 조회된 쿼리 결과를 JPA 캐시에 저장하여 재사용한다.

> JPA 1차 캐시
  - 영속성 컨텍스트 내부에 존재한다.
  - 동일한 트랜잭션 내에서만 1차 캐시가 존재한다.

> JPA 2차 캐시
  - 애플리케이션에서 동작하는 캐시이다.
  - 애플리케이션이 종료될때까지 유지된다.
  - 동시성 극대화를 위해 캐시를 그대로 반환하지 않고 복사본을 반환한다.
  - 캐시를 그대로 반환할 경우 여러 곳에서 수정할 수 있기 때문에 락을 걸어 해결할수는 있지만 비용적으로 복사본이 뛰어나다.
  - 1차 캐시에 비해 데이터베이스 조회 횟수를 줄일 수 있다.

> JPA 캐시 동작 방식
  ![cache 이미지](/JPA/images/cache.png)
  - 최초 조회시 영속성 컨텍스트에 데이터가 없으면 2차 캐시를 조회한다.
  - 2차 캐시에도 존재하지 않으면 데이터베이스를 조회하여 2차 캐시에 저장한다.
  - 2차 캐시의 복사본을 1차 캐시에 저장한다.

### 참고 사이트
- https://velog.io/@wnguswn7/JPA-%EC%BA%90%EC%8B%B1Caching%EA%B3%BC-%EC%98%81%EC%86%8D%EC%84%B1persistence
- https://devbksheen.tistory.com/entry/JPA-1%EC%B0%A8-%EC%BA%90%EC%8B%9C%EC%99%80-2%EC%B0%A8-%EC%BA%90%EC%8B%9C-%EC%86%8C%EA%B0%9C
